<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>wasm specs - WASM STUFF</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><li class="part-title">Resources</li><li class="chapter-item expanded "><div><strong aria-hidden="true">1.</strong> People</div></li><li class="chapter-item expanded "><a href="books_and_blogs.html"><strong aria-hidden="true">2.</strong> Books</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> Blogs</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> Papers</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.</strong> Communities</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> Projects</div></li><li class="chapter-item expanded affix "><li class="part-title">Notes</li><li class="chapter-item expanded "><a href="wasm_specs.html" class="active"><strong aria-hidden="true">7.</strong> wasm specs</a></li><li class="chapter-item expanded "><a href="wasm_validation.html"><strong aria-hidden="true">8.</strong> wasm validation</a></li><li class="chapter-item expanded "><a href="wasm_execution.html"><strong aria-hidden="true">9.</strong> wasm execution</a></li><li class="chapter-item expanded "><a href="wasmi_runtime.html"><strong aria-hidden="true">10.</strong> wasmi runtime</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">WASM STUFF</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="wasm-specs"><a class="header" href="#wasm-specs">Wasm Specs</a></h1>
<p>Again... these are short notes. A LOT has been left out. Read the latest official Docs to get full, structred information.</p>
<p><strong>Values</strong><br />
The supported types are :
- i32 (get used also as Boolean &amp; memory addresses.)
- i64
- f32
- f64
- A 128 bit type that acts as an Array/vector. You can insert the above base types into this 128-bit vector.
- Opaque references : opaque references refer to a type of data that represents pointers to different kinds of entities, but unlike other types, their size or representation is not observable.</p>
<p><strong>opaque references</strong><br />
These are references whose size or structure are hidden for security purposes. Meaning their bit patterns cannot be observed. In this case, the references are hidden from the wasm program itself. However, the references might be viewable to the runtime since it is the one that enforces the concealment. For example, you might need to hide references pointing to data from the Host.</p>
<p>The opposite of Opaque values is <strong>transparent values</strong>. Meaning that the bit patterns of the values are observable because they are not hidden.</p>
<p><strong>A table</strong> 
A table is a collection of indices that point to Opaque values. For now, the opaque values can be either Function references or value references. The runtime can therefore put an opaque reference to a host value.<br />
We need a table to help us implement dynamic calls and dynamic data-referencing in programs.<br />
Without it, we would have had to implement dynamicism through other methods such as an exhaustive compile-time monorphization. which would have resulted in bigger code size.</p>
<p><strong>Element Segments</strong><br />
Items stored in the table are called elements. The indices of the table are called element indices.<br />
When a wasm module is loaded by the runtime, All tables are initially empty. So it is up to the runtime to start filling the table accordingly.<br />
So the runtime checks if there is an &quot;element segment&quot; defined. An element segment is a place in the wasm code where 
- some elements have bee defined and are just waiting to be copied to the table
- there are some instructions on how to load those elements or pre-create new ones</p>
<p>An element segment is actually a vector of elements. The elements within can be in one of the following modes :</p>
<ol>
<li>Passive - it means you can copy them into the Table using the table.init instruction</li>
<li>Active - It means that that segment gets automatically added to the table during module initialization</li>
<li>Declarative - I did not understand this [undone]</li>
</ol>
<p><strong>Linear Memory</strong><br />
A linear memory is a contiguous, mutable array of raw bytes. Such a memory is created with an initial size but can be grown dynamically. A program can load and store values from/to a linear memory at any byte address (including unaligned). Integer loads and stores can specify a storage size which is smaller than the size of the respective value type. A trap occurs if an access is not within the bounds of the current memory size.</p>
<p><strong>References in wasm</strong><br />
A reference points to either an external object or a function.<br />
So we have the following grammar notation : [reftype ::= funcref | externref]<br />
All references in this case are opaque</p>
<p><strong>Limits to memory or tables</strong><br />
Limits classify the size range of resizeable storage associated with memory types and table types.<br />
If no maximum is given, the respective storage can grow to any size.<br />
Being that memory addresses are represented by 32bit integers, memory size cannot be larger than (2^32)bytes where 1 page = 64KB</p>
<p><strong>Data segments</strong><br />
The linear memory of the wasm module is usually empty before instantiation. So during instantiation, the runtime goes to look for a data segment(s) to see which variables it can load into the linear memory.<br />
A data segment is a vector that contains variables that need to be loaded into the linear memory.<br />
Variables that need to be immediately loaded at instantiation are labelled as : <strong>Active</strong><br />
Variables that can be loaded later through instructions such as mem.init are labelled as <strong>passive</strong></p>
<p><strong>Context</strong> 
Context is a collection of all the components in a certain scope. Here is a struct that abstracts this concept :
Context ::=
{<br />
types //
funcs
tables
mems
globals
elems
datas
locals
labels
return
refs
functype * ,
functype * ,
tabletype * ,
memtype * ,
globaltype * ,
reftype * ,
ok * ,
valtype * ,
resulttype * ,
resulttype ? ,
funcidx * 
}</p>
<p><strong>Miscellaneous</strong><br />
The type system ensures that the stack height, and thus any referenced register, is always known
statically. So the operand stack is implicit.</p>
<p>When an unrecoverable error occurs in the wasm code, a trap is thrown and the wasm code stops executing. the trap gets passed on to the host environment.</p>
<p>Functions can call each other, including recursively, resulting in an implicit call stack that cannot be accessed directly.</p>
<p>You can export something with one or more names... that's cool<br />
If you define a start function, it will act as main(). This is where execution will begin.</p>
<p>Vector instructions (also known as SIMD instructions, single instruction multiple data) provide basic operations
over values of vector type for the sake of performance.</p>
<p>The unreachable instruction causes an unconditional trap.</p>
<p>Each export is labeled by a unique name. Exportable definitions are functions, tables, memories, and globals,
which are referenced through a respective descriptor.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="books_and_blogs.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="wasm_validation.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="books_and_blogs.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="wasm_validation.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
